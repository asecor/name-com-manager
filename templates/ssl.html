<!DOCTYPE html>
<html>
<head>
    <title>SSL Monitor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body class="bg-gray-100">
    {% raw %}
    <div id="app" class="container mx-auto px-4 py-8">
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold">SSL Monitor</h1>
            <a href="/" class="text-blue-600 hover:underline">‚Üê DNS Manager</a>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-md mb-6">
            <textarea v-model="input" class="w-full border p-2 rounded h-32 mb-4" placeholder="Enter domains..."></textarea>
            <button @click="check" :disabled="loading" class="bg-purple-600 text-white px-6 py-2 rounded">
                {{ loading ? 'Checking...' : 'Check SSL Status' }}
            </button>
        </div>

        <div v-if="results.length" class="bg-white rounded-lg shadow-md">
            <table class="w-full text-left">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="p-4">Domain</th>
                        <th class="p-4">Expiry</th>
                        <th class="p-4">Days Left</th>
                        <th class="p-4">Issuer</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="r in results" class="border-t">
                        <td class="p-4 font-mono">{{ r.domain }}</td>
                        <td class="p-4">{{ r.expires }}</td>
                        <td class="p-4" :class="r.days_remaining < 15 ? 'text-red-600 font-bold' : ''">{{ r.days_remaining }}</td>
                        <td class="p-4 text-gray-500 text-sm">{{ r.issuer }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    {% endraw %}
    <script>
        const { createApp } = Vue
        createApp({
            data() { return { input: '', results: [], loading: false } },
            methods: {
                async check() {
                    this.loading = true;
                    const domains = this.input.split('\n').filter(d => d.trim());
                    const res = await fetch('/api/ssl-check', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ domains })
                    });
                    this.results = await res.json();
                    this.loading = false;
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
